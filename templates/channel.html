<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>channel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css">
    <link href="{{ url_for('static', filename='css/font-awesome.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/co-style.css') }}" rel="stylesheet">
    <script src="{{ url_for('static', filename='js/jquery-1.11.2.min.js') }}"></script>
{#    <script src="//cdn.bootcss.com/bootstrap/4.0.0-alpha.2/js/bootstrap.min.js"></script>#}
    <script type="text/javascript">
        var addPost = function () {
            $('#id-button-write-post').on('click', function () {
                console.log('点击增加文章');
                var title = $('#id-text-post-title').val();
                console.log('新文章题目: ', title);
                var content = $('#id-text-post-content').val();
                console.log('新文章内容: ', content);
                var channel_id = $('#id-post-channel').val();
                console.log('文章的频道: ', channel_id);
                var data = {
                    title: title,
                    content: content,
                    channel_id: channel_id,
                };
                postData = JSON.stringify(data);
                console.log('postData: ', postData);
                $.ajax({
                    url: '/role/add',
                    type: 'POST',
                    data: postData,
                    contentType: 'application/json',
                    success: function (d) {
                        r = JSON.parse(d);
                        console.log('add role返回数据: ', r);

                    }
                });
            });
        };

    </script>

</head>
<body>
<!-- Left column -->
<div class="templatemo-flex-row">
    <div class="templatemo-sidebar">
        <header class="templatemo-site-header">
            <div class="square"></div>
            <h1> Cocode</h1>
        </header>
        <div class="profile-photo-container">
            <img src="{{ url_for('static', filename='images/profile-photo.jpg') }}" class="img-responsive">
            <div class="profile-photo-overlay"></div>
        </div>
        {#        <!-- Search box -->#}
        {#        <form class="templatemo-search-form" role="search">#}
        {#          <div class="input-group">#}
        {#              <button type="submit" class="fa fa-search"></button>#}
        {#              <input type="text" class="form-control" placeholder="Search" name="srch-term" id="srch-term">#}
        {#          </div>#}
        {#        </form>#}
        <br>
        <div class="mobile-menu-icon">
            <i class="fa fa-bars"></i>
        </div>
        <nav class="templatemo-left-nav">
            <ul>
                <li><a href="/channel/list" class="active"><i class="fa fa-home fa-fw"></i>频 道</a></li>
                {% for c in channels %}
                    <li>
                        <a href="/channel/{{ c.id }}" class="pure-menu-heading">
                            <i class="fa fa-map-marker fa-fw"></i>
                            {{ c.name }}
                        </a>
                    </li>
                {% endfor %}
                {#            <li><a href="data-visualization.html"><i class="fa fa-bar-chart fa-fw"></i></a></li>#}
                {#            <li><a href="data-visualization.html"><i class="fa fa-database fa-fw"></i>Data Visualization</a></li>#}
                {#            <li><a href="maps.html"><i class="fa fa-map-marker fa-fw"></i>Maps</a></li>#}
                {#            <li><a href="manage-users.html"><i class="fa fa-users fa-fw"></i>Manage Users</a></li>#}
                {#            <li><a href="preferences.html"><i class="fa fa-sliders fa-fw"></i>Preferences</a></li>#}
                {#            <li><a href="login.html"><i class="fa fa-eject fa-fw"></i>Sign Out</a></li>#}
            </ul>
        </nav>
    </div>
    <!-- Main content -->
    <div class="templatemo-content col-1 light-gray-bg">
        <div class="templatemo-top-nav-container">
            <div class="row">
                <nav class="templatemo-top-nav col-lg-12 col-md-12">
                    <ul class="text-uppercase">
                        {% if is_admin %}
                            <li><a href="/admin" class="active">管理</a></li>
                            <li><a href="">用户列表</a></li>
                        {% endif %}
                        <li><a href="/user/{{ user.id }}">{{ user.username }}</a></li>
                        <li><a href="/login">登录</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="templatemo-content-container">
            <div class="templatemo-flex-row flex-content-row">

                {#            {% for p in posts %}#}
                {#                <tr>#}
                {#                    <td>{{ p.link | safe }}</td>#}
                {#                    <td>{{ p.time }}</td>#}

                {#                </tr>#}
                {#            {% endfor %}#}
                {% for p in posts %}
                    <div class="templatemo-content-widget white-bg col-2">
                        {% if is_admin or p.is_author(user) %}
                            <a href="/post/delete/{{ p.id }}"><i class="fa fa-times"></i></a>
                        {% endif %}

                        <div class="square"></div>
                        <h2 class="templatemo-inline-block">{{ p.link | safe }}</h2>
                        <hr>
                        <p>{{ p.author_link | safe }} 发表于: {{ p.time }}</p>
                        <p>{{ p.part_content }}</p>
                    </div>
                {% endfor %}
            </div>
{#            <div class="row form-group">#}
                <div class="col-lg-12 form-group">
                    <label for="id-text-post-title"></label>
                    <input type="text" class="form-control" id="id-text-post-title" placeholder="标题" name="title" required>
                    <textarea class="form-control" id="id-text-post-content" rows="3" placeholder="写点啥" name="content" required></textarea>
                    <input type="hidden" id="id-post-channel" name="channel_id" value="{{ channel.id }}">
                    <button id="id-button-write-post" class="templatemo-blue-button float-right">提 交</button>
                </div>
{#            </div>#}
            {#        <form action="/post/add" method="POST" class="pure-form pure-form-aligned">#}
            {#                <fieldset>#}
            {#                    <textarea class="pure-input-1-2" placeholder="编辑标题" name="title" required></textarea>#}
            {#                    <textarea class="text-link pure-input-1-2" placeholder="新帖子..." name="content" required></textarea>#}
{#                                <input type="hidden" name="channel_id" value="{{ channel.id }}">#}
            {#                    <button type="submit" class="button-submit pure-button pure-button-primary">提交</button>#}
            {#                </fieldset>#}
            {#             </form>#}
        </div>
    </div>
    {#<div class="pure-g">#}
    {##}
    {#    <div class="sidebar pure-u-1 pure-u-md-1-4">#}
    {#        <a href="/channel/list" class="primary-button pure-button">频道</a>#}
    {#        <div class="pure-menu pure-menu-open">#}
    {#            <ul>#}
    {#                {% for c in channels %}#}
    {#                    <li><a href="/channel/{{ c.id }}" class="pure-menu-heading">{{ c.name }}</a></li>#}
    {#                {% endfor %}#}
    {#            </ul>#}
    {#        </div>#}
    {#    </div>#}
    {##}
    {#    <div class="content pure-u-1 pure-u-md-3-4">#}

    {#        </form>#}
    {#        <table class="pure-table">#}
    {#            <thead>#}
    {#            <tr>#}
    {#                <th>帖子</th>#}
    {#                <th>创建时间</th>#}
    {#                <th>管理</th>#}
    {#            </tr>#}
    {#            </thead>#}
    {#            <tbody>#}
    {#            {% for p in posts %}#}
    {#                <tr>#}
    {#                    <td>{{ p.link | safe }}</td>#}
    {#                    <td>{{ p.time }}</td>#}
    {#                    {% if is_admin or p.is_author(user) %}#}
    {#                    <td><a href="/post/delete/{{ p.id }}">删除</a></td>#}
    {#                    {% endif %}#}
    {#                </tr>#}
    {#            {% endfor %}#}
    {#            </tbody>#}
    {#        </table>#}
    {#    </div>#}
    {#</div>#}
</body>
</html>